ИМПОРТ EXCEL
//Выбор файла
&НаКлиенте
Процедура Загрузить(Команда) 
	ВыборФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие); 
	ВыборФайла.МножественныйВыбор = Ложь;
	ВыборФайла.Фильтр = "Табличные документы *.xlsx | *.xlsx";
	ВыборФайла.Показать(Новый ОписаниеОповещения("ЗагрузитьНаСервере", ЭтотОбъект,Новый Структура)); 
КонецПроцедуры

//Загрузка данных в справочник
&НаСервереБезКонтекста
Процедура ЗагрузитьНаСервере(Результат,ДопПараметр)
	// Проверка выбора файла
	Если НЕ(Результат = Неопределено) Тогда
		 СсылкаНаФайл = Результат[0];
	Иначе
		Сообщить("Файл не выбран!");
		Возврат;
	КонецЕсли;
	//обращение к данным
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.Прочитать(СсылкаНаФайл);
	//Чтение данных
	Для Строка = 2  По ТабДок.ВысотаТаблицы  Цикл
		ЭлементФурнитура = Справочники.Фурнитура.СоздатьЭлемент();
		//Наименование
		ЭлементФурнитура.Наименование = ТабДок.Область(Строка,2).Текст;	
		//Артикул
		ЭлементФурнитура.Артикул = ТабДок.Область(Строка,1).Текст;
		//Количество
		ЭлементФурнитура.Количество = ТабДок.Область(Строка,3).Текст;
		//Единица измерения
		ЕдИзмТабл = ТабДок.Область(Строка,4).Текст ;
        Если Справочники.ЕдИзм.НайтиПоНаименованию(ЕдИзмТабл,Истина) = Справочники.ЕдИзм.ПустаяСсылка() Тогда   // такого элемента нет
            ЭлементЕдИзм = Справочники.ЕдИзм.СоздатьЭлемент();
            ЭлементЕдИзм.Наименование = ЕдИзмТабл;
            ЭлементЕдИзм.Записать();
            Сообщить ( "В справочник Единицы измерения добавлена запись " + ЭлементЕдИзм.Наименование);
        КонецЕсли;
        ЭлементФурнитура.ЕдИзмерения = Справочники.ЕдИзм.НайтиПоНаименованию(ЕдИзмТабл,Истина);		
		//Тип фурнитуры    
		ТипФурнитурыТабл = ТабДок.Область(Строка,5).Текст;
		Если Справочники.ТипыФурнитуры.НайтиПоНаименованию(ТипФурнитурыТабл,Истина) = Справочники.ТипыФурнитуры.ПустаяСсылка() Тогда // такого элемента нет
        	Типфур = Справочники.ТипыФурнитуры.СоздатьЭлемент();
			Типфур.Наименование = ТипФурнитурыТабл; 
			ТипФур.Записать();
			Сообщить ( "В справочник Типы фурнитуры добавлена запись " + ТипФур.Наименование); 
		КонецЕсли;
		ЭлементФурнитура.Тип = Справочники.ТипыФурнитуры.НайтиПоНаименованию(ТипФурнитурыТабл,Истина);
		//Цена
		ЭлементФурнитура.Цена = ТабДок.Область(Строка,6).Текст;
		ЭлементФурнитура.Записать();
		Сообщить("В справочник Фурнитура добавлена запись "+ ЭлементФурнитура.Наименование);
	КонецЦикла;
КонецПроцедуры
 
